<html>
<head>
    <title>$action.getActionName($action.getClass().getName())</title>
</head>
<body>

#requireResource('confluence.admin.user:entitypicker')
#requireResource("com.atlassian.confluence.plugins.confluence-scriptsfinished-plugin:scriptsfinished")

<div>
    #parse ( "/template/includes/actionerrors.vm" )

    <form action="$htmlUtil.urlEncode($actionName)" name="grouppickerform" class="aui">
        <div style="margin-top: 8px">
            #set($_params = {
                "labelContent":"$i18n.getText('')",
                "id": "groupnameTerm",
                "name": "groupnameTerm",
                "size": "'50'",
                "extraClasses": "text long-field",
                "isAutofocus": "true",
                "value": $!groupnameTerm,
                "type": "#if($editMode == false)value#{else}text#end",
                "isDisabled": false})
            $soyTemplateRendererHelper.getRenderedTemplateHtml(
                "com.atlassian.auiplugin:aui-experimental-soy-templates", "aui.form.input.soy", $_params)
            <input type="submit" value="Search" class="button"/><br/>
            <span class="stepdesc">$action.getText("search.example")</span>
        </div>

        <input type="hidden" name="onPopupSubmit" value="$htmlUtil.htmlEncode($!onPopupSubmit)" />
        <input type="hidden" name="key" value="$htmlUtil.htmlEncode($!key)" />
        <input type="hidden" name="actionName" value="$htmlUtil.htmlEncode($!actionName)" />
        <input type="hidden" name="existingGroups" value="$htmlUtil.htmlEncode($!existingGroups)" />
    </form>

    #parse( "/spaces/permissions/grouppicker-results.vm" )
</div>


#if ($action.excludedGroups.size() > 0)
<div class="greybox">
    $action.getText('groups.excluded', ["<strong>$htmlUtil.htmlEncode($action.commaSeparatedExcludedGroupNames)</strong>"])
</div>
#end


</body>
</html>
