define("confluence/view-my-drafts",["jquery","ajs","backbone","confluence/templates"],function(b,c,e,f){return e.View.extend({events:{"click .view-legacy-draft":"open"},initialize:function(){this.$el.append(f.LegacyDrafts.render());var a=c.dialog2("#legacy-draft-dialog");this.model.set({dialog:a});var b=this;a.$el.find(".close").on("click",function(){a.hide()});a.on("hide",function(){b.close(b)})},render:function(){var a=this.model.get("dialog");a.$el.find(".aui-dialog2-header-main").text(this.model.get("title"));
a.$el.find(".aui-dialog2-content").html(this.model.get("content"))},open:function(a){a.preventDefault();c.trigger("analytics",{name:"confluence.viewsource.resume.legacy.draft"});var d=this,e=b(a.target).data("draftid"),f=b(a.target).data("drafttitle"),a=this.model.getPage(e);a.done(function(a){a=a.content;a||(a=c.I18n.getText("draft.no.content"),b(".legacy-draft-container").addClass("empty-draft"),b(".legacy-draft-hint").addClass("legacy-hint-no-display"));d.model.get("dialog").show();d.model.set({title:f,
content:a});d.render();b("body").addClass("no-select")});a.fail(function(){d.model.get("dialog").show();d.model.set({title:c.I18n.getText("view.draft.error"),content:""});b(".legacy-draft-hint").addClass("legacy-hint-no-display");d.render()})},close:function(a){a.model.set({title:"",content:""});b("body").removeClass("no-select");b(".legacy-draft-container").removeClass("empty-draft");b(".legacy-draft-hint").removeClass("legacy-hint-no-display")}})});
require("confluence/module-exporter").safeRequire("confluence/view-my-drafts",function(b){var c=require("ajs"),e=require("backbone"),f=require("jquery"),a=new e.Model;a.getPage=function(a){return c.safe.ajax({type:"GET",url:c.contextPath()+"/rest/viewsrc/1.0/getPageSrc",data:{pageId:a}})};c.toInit(function(){new b({el:f("body"),model:a})})});