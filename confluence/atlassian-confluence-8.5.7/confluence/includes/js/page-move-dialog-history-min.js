define("confluence/page-move-dialog-history",["jquery","confluence/templates","ajs"],function(c,g,e){return function(f){var h=c("#confluence-context-path").attr("content"),d=this,b=c(".search-results",d);c(b).keydown(function(b){function e(a){var b=c(".search-result",d),f=c(".search-result.selected",d),a=b.index(f)+a;0>a&&(a=b.length-1);a>=b.length&&(a=0);b.eq(a).click()}38===b.which?e(-1):40===b.which&&e(1)});b.html(g.MovePage.pageHistoryLoading());c.ajax({type:"GET",dataType:"json",data:{types:["spacedesc",
"personalspacedesc","page"]},url:h+"/json/history.action",error:function(){f.error(e.params.movePageDialogHistoryError)},success:function(d,g){"success"!=g?f.error(e.params.movePageDialogHistoryError):!d.history||0===d.history.length?b.html("<div class='no-results'>"+e.I18n.getText("move.page.dialog.history.no.results")+"</div>"):(b.html(e.getTemplate("searchResultsGrid").toString()),c.each(d.history,function(){var a=this;if(a.id!=e.params.pageId){var d=c(e.renderTemplate("searchResultsGridRow",[a.title,
h+a.url,a.type,a.spaceName,a.spaceKey,a.friendlyDate,a.date]));c(d).click(function(d){"page"==a.type?f.select(a.spaceKey,a.spaceName,a.title,a.id):f.select(a.spaceKey,a.spaceName);b.find(".selected").removeClass("selected");c(this).addClass("selected");d.stopPropagation();return!1});c(d).hover(function(){c(this).addClass("hover")},function(){c(this).removeClass("hover")});b.find("table").append(d)}}),0===c(".search-result",b).length&&b.html("<div class='no-results'>"+e.I18n.getText("move.page.dialog.history.no.results")+
"</div>"))}})}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/page-move-dialog-history","jQuery.fn.movePageHistory");