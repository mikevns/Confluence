define("confluence/pages-dirview",["ajs","jquery","confluence/meta","confluence/api/constants"],function(a,c,g,b){var f=function(d){var e="";d.actionErrors&&d.actionErrors.length&&(e=d.actionErrors.join("<br>"),a.log("ajax parameters invalid : "+e));c("#resultsDiv").html(e)};return function(){var d=c("#tree-div").tree({url:b.CONTEXT_PATH+"/pages/children.action",initUrl:b.CONTEXT_PATH+"/pages/children.action?spaceKey="+encodeURIComponent(g.get("space-key"))+"&node=root",parameters:["pageId"],nodeId:"pageId",
drop:function(){c(this.source).addClass("flash");var e={pageId:this.source.pageId,position:this.position,targetId:this.target.pageId,mode:"LEGACY"};a.trigger("analytics",{name:"confluence.page.hierarchy.reorder",data:{}});a.safe.post(b.CONTEXT_PATH+"/pages/movepage.action",e,f,"json")},order:function(){c.getJSON(b.CONTEXT_PATH+"/pages/revertpageorder.action",{pageId:this.source.pageId},f)},orderUndo:function(){var a=this.source.pageId,d=c.map(this.orderedChildren,function(a){return a.pageId}).join();
c.getJSON(b.CONTEXT_PATH+"/pages/setpageorder.action",{pageId:a,orderedChildIds:d},f)},onready:function(){var e;a.params.expandedNodes||(a.params.expandedNodes=[]);a.params.openId&&(e=function(){d.findNodeBy("pageId",a.params.openId).highlight()});for(var c=[],b=0,f=a.params.expandedNodes.length;b<f;b++)c[b]={pageId:a.params.expandedNodes[b]};d.expandPath(c.reverse(),e)}})}});require("confluence/module-exporter").safeRequire("confluence/pages-dirview",function(a){require("ajs").toInit(a)});