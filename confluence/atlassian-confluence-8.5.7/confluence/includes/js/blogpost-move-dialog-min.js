define("confluence/blogpost-move-dialog","ajs jquery confluence/legacy confluence/meta confluence/templates confluence/api/ajax confluence/api/event confluence/api/logger confluence/message-controller confluence/form-state-control wrm/context-path".split(" "),function(b,c,l,f,m,n,o,p,q,j,k){function r(a,g,e){function h(a){e(a);j.enableElement([f,d]);c(".button-spinner").spinStop()}function i(a){o.trigger("analyticsEvent",{name:a,data:{newSpaceKey:g,oldSpaceKey:b.params.spaceKey,blogPostId:b.params.pageId}})}
a=c("#move-blogpost-dialog");a.find(".move-errors").empty();c(".button-spinner").spin();var f=c(".move-button")[0],d=a.find(".button-panel-cancel-link")[0];j.disableElement([f,d]);g===""?h(b.I18n.getText("move.blogpost.dialog.no.space.selected")):n.ajax({url:k()+"/pages/moveblogpost.action",type:"POST",dataType:"json",timeout:18E4,data:{blogPostId:b.params.pageId,spaceKey:g},error:function(a){h(q.parseError(a,b.I18n.getText("move.blogpost.dialog.move.failed")));i("moveblogpost.ajaxError")},success:function(a){var b=
[].concat(a.validationErrors||[]).concat(a.actionErrors||[]).concat(a.errorMessage||[]);if(b.length>0){h(b[0]);i("moveblogpost.serverValidationError")}else{i("moveblogpost.success");window.location.href=k()+a.blogPost.url+(a.blogPost.url.indexOf("?")>=0?"&":"?")+"moved=true"}}})}function d(a){function d(a){c("#move-blogpost-dialog .move-errors").empty();b.messages.error("#move-blogpost-dialog .move-errors",{body:a,closeable:false})}var e=c.extend({spaceKey:f.get("space-key"),spaceName:f.get("space-name"),
title:b.I18n.getText("move.blogpost.dialog.title"),buttonName:b.I18n.getText("move.name"),moveHandler:function(a){p.debug("No move handler defined. Closing dialog.");a.remove()},cancelHandler:function(a){a.remove();return false}},a),a=b.ConfluenceDialog({width:s,height:t,id:"move-blogpost-dialog"});a.addHeader(e.title);a.addPanel(b.I18n.getText("move.blogpost.dialog.panel.title"),m.MoveBlogPost.dialogPanel(),"move-blogpost-dialog-panel","move-blogpost-dialog-panel-id");c("#new-space").auiSelect2(l.UI.Components.SpacePicker.build());
a.addButton(e.buttonName,function(a){var b=c("#new-space").val();e.moveHandler(a,b,d)},"move-button aui-button aui-button-primary");c(".button-panel-button.move-button").attr("id","move-button");a.addCancel(b.I18n.getText("cancel.name"),e.cancelHandler);a.popup.element.find(".dialog-button-panel").prepend("<div class='button-spinner'>&nbsp;</div>");a.show();return a}var s=400,t=250;return{control:d,initialiser:function(a){a.preventDefault();c("#move-blogpost-dialog").length>0&&c("#move-blogpost-dialog, body > .shadow, body > .aui-blanket").remove();
new d({moveHandler:r});return false}}});require("confluence/module-exporter").safeRequire("confluence/blogpost-move-dialog",function(b){var c=require("confluence/api/event");require("confluence/legacy").MoveBlogPostDialog=b.control;c.bind("deferred.blog-move.tools-menu.click",b.initialiser);c.trigger("blogpost.move.dialog.ready")});