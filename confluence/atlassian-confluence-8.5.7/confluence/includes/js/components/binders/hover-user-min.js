define("confluence/hover-user",["jquery","confluence/dark-features","confluence/content-hover","ajs","confluence/meta"],function(b,i,j,g,f){var d=[],h=g.contextPath();if(f.get("remote-user")&&!f.get("remote-user-has-licensed-access"))return b.noop;var k=function(a){var c=d[a],e={username:c,target:this};b(self).trigger("hover-user.open",e);b(".ajs-menu-bar",this).ajsMenu();b(".follow, .unfollow",this).each(function(){var a=b(this).click(function(d){if(!a.hasClass("waiting")){var f=a.hasClass("unfollow")?
"/unfollowuser.action":"/followuser.action";a.addClass("waiting");g.safe.post(h+f+"?username="+encodeURIComponent(c)+"&mode=blank",{},function(){a.removeClass("waiting");a.parent().toggleClass("follow-item").toggleClass("unfollow-item");b(self).trigger("hover-user.follow",e)});d.stopPropagation();return!1}})})},l=i.isEnabled("show.business.group.in.user.hover");return function(){b("span.user-hover-trigger, a.confluence-userlink, img.confluence-userlink, a.userLogoLink").filter("[data-user-hover-bound!='true']").each(function(){var a=
b(this),c=a.attr("data-username");a.attr("title","").attr("data-user-hover-bound","true");b("img",a).attr("title","");var e=b.inArray(c,d);-1===e&&(d.push(c),e=b.inArray(c,d));a.addClass("userlink-"+e)});b.each(d,function(a){var c=h+"/users/userinfopopup.action?username="+encodeURIComponent(d[a]);l&&(c+="&profileGroups=business");j(b(".userlink-"+a),a,c,k)})}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/hover-user","Confluence.Binder.userHover");